name: vcc
function: coarse-channelisation
domain: sensing
command: "Vcc"
instances: ["vcc"]
depends_on:
  - device: sys/database/2
livenessProbe:
{{ toYaml $.Values.livenessProbe | indent 2 }}
readinessProbe:
{{ toYaml $.Values.readinessProbe | indent 2 }}
image:
{{- with $.Values.midcbf.image}}
  registry: {{ .registry | quote}}
  image: {{ .image | quote}}
  tag: {{ .tag | quote}}
  pullPolicy: {{ .pullPolicy | quote}}
{{- end }}
server:
  name: "Vcc"
  instances:
  - name: "vcc"
    classes:
    - name: "Vcc"
      devices:
      {{- $numVcc := (add1 $.Values.numVcc | int) }}
      {{- range untilStep 1 $numVcc 1 }}
      {{- $vcc_id := .}}
      - name: {{ printf "%s/%02d" $.Values.vccTrl $vcc_id }}
        properties:
          - name: "DeviceID"
            values:
            - {{ quote $vcc_id }}
          - name: "TalonLRUAddress"
            values:
            - {{ printf "mid_csp_cbf/talon_lru/%03d" (div $vcc_id 2 | int) }}
          - name: "VccControllerAddress"
            values:
            - {{ printf "talondx-%03d/vcc-app/vcc-controller" $vcc_id }}
          - name: "Band1And2Address"
            values:
            - {{ printf "talondx-%03d/vcc-app/vcc-band-1-and-2" $vcc_id }}
          - name: "Band3Address"
            values:
            - {{ printf "talondx-%03d/vcc-app/vcc-band-3" $vcc_id }}
          - name: "Band4Address"
            values:
            - {{ printf "talondx-%03d/vcc-app/vcc-band-4" $vcc_id }}
          - name: "Band5Address"
            values:
            - {{ printf "talondx-%03d/vcc-app/vcc-band-5" $vcc_id }}
          - name: "LRCTimeout"
            values:
            - {{ quote $.Values.vccTimeout }}
      {{- end }}
